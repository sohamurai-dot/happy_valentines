<!DOCTYPE html>
      videoElement.playsInline = true;
      slideshow.appendChild(videoElement);
    } else {
      imageElement = document.createElement('img');
      imageElement.src = slide.src;
      imageElement.className = 'slide-media';
      slideshow.appendChild(imageElement);
    }
    slideQuote.innerHTML = slide.quote;
    slideProgress.innerText = `Slide ${idx+1} of ${slides.length}`;
    backIcon.setAttribute("aria-disabled", idx === 0 ? "true" : "false");
  }
  function startSlideshow() {
    slideshow.classList.remove('hidden');
    finalMsg.classList.add('hidden');
    slideIdx = 0;
    showSlide(slideIdx);
    timer = setInterval(nextSlide, 4600);
  }
  function nextSlide() {
    if (slideIdx < slides.length - 1) {
      slideIdx++;
      showSlide(slideIdx);
    } else {
      endSlideshow();
    }
  }
  function endSlideshow() {
    clearInterval(timer);
    slideshow.classList.add('hidden');
    finalMsg.classList.remove('hidden');
  }
  backIcon.addEventListener('click', function (e) {
    if (slideIdx > 0) {
      slideIdx--;
      showSlide(slideIdx);
      clearInterval(timer);
      timer = setInterval(nextSlide, 4600);
    }
  });
  slideshow.addEventListener('click', function (evt) {
    if (evt.target === backIcon) return;
    nextSlide();
    clearInterval(timer);
    timer = setInterval(nextSlide, 4600);
  });

  // ---------- Simple Confetti Hearts & Roses ----------
  const confetti = document.getElementById('confetti');
  const emojis = ['ðŸ’–','ðŸŒ¹','â¤ï¸','ðŸ’˜','ðŸ’—','ðŸ’ž','ðŸ’•','ðŸ’'];
  function spawnConfetto(){
    const emoji = emojis[Math.floor(Math.random() * emojis.length)];
    const el = document.createElement('span');
    el.innerText = emoji;
    el.style.position = 'absolute';
    el.style.fontSize = (Math.random()*22+28) + 'px';
    el.style.left = (Math.random()*98)+'vw';
    el.style.top = '102vh';
    el.style.opacity = Math.random()*0.7 + 0.3;
    el.style.transition = 'transform 3.8s linear, opacity 3.8s linear';
    confetti.appendChild(el);
    setTimeout(()=>{
      el.style.transform = `translateY(-105vh) rotate(${Math.random()*360-180}deg)`;
      el.style.opacity = 0.1;
    }, 30);
    setTimeout(()=>{el.remove()}, 4100);
  }
  setInterval(spawnConfetto, 320);
</script>
</body>
</html>
